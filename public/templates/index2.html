<!-- <p ng-show="enpoints.length == 0">No hay datos para mostrar</p> -->

<nav class="navbar navbar-inverse navbar-fixed-top">
 <div class="container-fluid">
   <div class="navbar-header">
     <a class="navbar-brand" href>Monitor de ambientes Amdocs</a>
   </div>
   <ul class="nav navbar-nav navbar-right">
     <li class="active"><a href>Bienvenido </a></li>
      <li>
        <a ng-href="#notification" title="Dismissible popover" data-toggle="popover" data-trigger="focus" 
          data-content="Click anywhere in the document to close this popover">
          <span class="glyphicon glyphicon-bell"></span> {{ errorCount }} 
        </a>
      </li>
     <li class="active"><a href="">Salir</a></li>
   </ul>
 </div>
</nav>

<!--<H1>Monitor de ambientes Amdocs</H1>-->
<div class="well well-sm">
  <table width="100%">
    <tr>
      <td align="left">Ultima actualizacion: <span>{{ date | date:'medium'}} </span></td>
      <td align="right">Fecha: <span my-current-time="format"></span></td>
    </tr>
  </table>
</div>

<form>
    <div class="form-group">
      <div class="input-group">
        <div class="input-group-addon"><i class="fa fa-search"></i></div>
        <input type="text" class="form-control" placeholder="Filtrar" ng-model="buscador">
      </div>
    </div>
</form>

<div class="alert alert-warning" ng-hide="buscador == ''">
  <p >Filtrado por  {{ buscador }} </p>
</div>

<!-- Modal -->
<div id="myModal" class="modal fade" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Detalles del error</h4>
      </div>
      <div class="modal-body">
        <p>{{ lastError }}</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
      </div>
    </div>

  </div>
</div>

<!-- Filtrar: <input type="text" ng-model="buscador"  /> -->
<table class="table table-bordered table-striped">
    <thead>
      <tr>
        <td>
          <a href="" ng-click="sortType = 'name'; sortReverse = !sortReverse">
            Nombre
            <span ng-show="sortType == 'name' && !sortReverse" class="fa fa-caret-down"></span>
            <span ng-show="sortType == 'name' && sortReverse" class="fa fa-caret-up"></span>
          </a>
        </td>
        <!-- <td>Nombre</td> -->
        <td>
          <a href="" ng-click="sortType = 'env'; sortReverse = !sortReverse">
            Ambiente
            <span ng-show="sortType == 'env' && !sortReverse" class="fa fa-caret-down"></span>
            <span ng-show="sortType == 'env' && sortReverse" class="fa fa-caret-up"></span>
          </a>
        </td>
        <!-- <td>Ambiente</td> -->
        <td>URL</td>
        <td>Ultimo Error</td>
        <td>Codigo HTTP</td>
        <!-- <td>Estado</td> -->
        <td>
          <a href="" ng-click="sortType = 'isOK'; sortReverse = !sortReverse">
            Estado
            <span ng-show="sortType == 'isOK' && !sortReverse" class="fa fa-caret-down"></span>
            <span ng-show="sortType == 'isOK' && sortReverse" class="fa fa-caret-up"></span>
          </a>
        </td>
        <td>BTP</td>
      </tr>
    </thead>
    <tbody>
      <!-- <tr ng-repeat="end in endpoints | orderBy:sortType:sortReverse | filter:buscador"> -->
      <tr ng-repeat="end in endpoints | orderBy:sortType:sortReverse | filter: buscador">
        <td>{{ end.name }}</td>
        <td>{{ end.env }}</td>
        <td>
            <a ng-show="end.type != 'ASM'" href="{{ end.url }}" target="_blank" title="Abrir en otra ventana">{{ end.url }}</a>
            <p ng-show="end.type == 'ASM'">ASM</p>
        </td>
        <td>{{ end.firstErrorDate  | date:'medium' }}
                <!-- Trigger the modal with a button -->
                <!-- <button type="button" ng-show="end.firstErrorDate != null" class="btn btn-info btn-lg" ng-click='showModal()'>Detalles</button> -->
        </td>
        <td><a ng-show="end.httpCode !=0" href="{{'https://httpstatuses.com/' + end.httpCode}}" target="_blank" title="Ver documentacion">{{ end.httpCode }}</a></td>
        <td style="font-weight: bold">
            <p ng-show="end.isOK" style="color: green">OK</p>
            <p ng-show="!end.isOK" style="color: red">ERROR</p>
        </td>
        <td style="align: center">
            <button type="button" ng-show="end.type == 'ASM'" class="btn btn-default btn-xs"
                    ng-click="refreshBPT(end.name, end.ip, end.port)"
                    title="Esta tarea puede tardar mas de 1 minutos. Uselo con cuidado"
                    data-toggle="tooltip" data-placement="bottom">Refrescar</button>
            <p ng-show=" refreshStatusList[end.name] != ''">{{ refreshStatusList[end.name] }}</p>
        </td>
      </tr>
    </tbody>
 </table>
